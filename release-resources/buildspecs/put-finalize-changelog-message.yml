version: 0.2

phases:
  install:
    commands:
      - apt-get update
      - apt-get install python3 python3-pip -y
      - update-alternatives --install /usr/bin/python python /usr/bin/python3 10
      - update-alternatives --install /usr/bin/pip pip /usr/bin/pip3 10
      - pip install awscli --upgrade --user

  build:
    commands:
      - RELEASE_DATE=`TZ=US/Pacific date "+%Y-%m-%d"`
      - MESSAGE=`cat $VERSION_PROPERTIES`
      - |
        MESSAGE="$MESSAGE
        releaseDate=$RELEASE_DATE"
      - |
      - echo "$MESSAGE"
      - aws sqs send-message --queue-url $QUEUE_URL --message-body "$MESSAGE" --message-group-id "FinalizeChangelogGroup"